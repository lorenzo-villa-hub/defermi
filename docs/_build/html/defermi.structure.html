

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; defermi 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=292eb321"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="defermi.thermodynamics.html" />
    <link rel="prev" title="&lt;no title&gt;" href="defermi.plotter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            defermi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">defermi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="defermi.html">defermi package</a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/defermi.structure.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p id="module-defermi.structure">Created on Tue Apr  4 17:10:46 2023</p>
<p>&#64;author: villa</p>
<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.create_def_structure_for_visualization">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">create_def_structure_for_visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_defect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_bulk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_to_bulk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#create_def_structure_for_visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.create_def_structure_for_visualization" title="Link to this definition"></a></dt>
<dd><p>Create defect structure for visualization in OVITO. The vacancies are shown by inserting
in the vacant site the element of same row and next group on the periodic table.
If sort_to_bulk is True the Sites are sorted to match the Bulk structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_defect</strong> (<em>Structure</em>) – Defect structure.</p></li>
<li><p><strong>structure_bulk</strong> (<em>Structure</em>) – Bulk structure.</p></li>
<li><p><strong>defects</strong> (<em>list</em>) – List of defect objects. If None <cite>defect_finder</cite> is used.</p></li>
<li><p><strong>sort_to_bulk</strong> (<em>bool</em>) – Sort Sites of the defect structure to match the order of coordinates in the bulk structure
(useful if the non-relaxed defect structure is not available).
If False only the dummy atoms are inserted and not further changes are made.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance for site comparison. The distance between sites in target and reference stucture is used,
periodicity is accounted for. The tolerance is normalized with respect to lattice vector size.
The default is 1e-03.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_structure</strong> – Structure with dummy atoms as vacancies and interstitials at the end of the list.
The order of the sites follow the order of the Bulk structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.create_interstitial_structures">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">create_interstitial_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#create_interstitial_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.create_interstitial_structures" title="Link to this definition"></a></dt>
<dd><p>Create interstitial structures based on Voronoi with <cite>pymatgen</cite>,
staring from a bulk structure (unit cell or supercell).
Uses <cite>Interstitial</cite> objects generated with the <cite>generator</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Bulk structure.</p></li>
<li><p><strong>elements</strong> (<em>list</em>) – List of element symbols.</p></li>
<li><p><strong>supercell_size</strong> (<em>int</em>) – Input for the make_supercell function of the Structure class.
If None the input structure is not modified.</p></li>
<li><p><strong>kwargs</strong> – <p>Kwargs to pass to VoronoiInterstitialGenerator:</p>
<ul>
<li><p>clustering_tol: Tolerance for clustering the Voronoi nodes.</p></li>
<li><p>min_dist: Minimum distance between an interstitial and the nearest atom.</p></li>
<li><p>ltol: Tolerance for lattice matching.</p></li>
<li><p>stol: Tolerance for structure matching.</p></li>
<li><p>angle_tol: Angle tolerance for structure matching.</p></li>
<li><p>kwargs: Additional keyword arguments for the <cite>TopographyAnalyzer</cite> constructor.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>structures</strong> – List of interstitial structures.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.create_substitution_structures">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">create_substitution_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements_to_replace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#create_substitution_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.create_substitution_structures" title="Link to this definition"></a></dt>
<dd><p>Create substitution structures for each non-equivalent site,
staring from a bulk structure (unit cell or supercell).
Uses <cite>Substitution</cite> objects generated with the <cite>generator</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Bulk structure, both unit cell or supercell can be used as input.</p></li>
<li><p><strong>elements_to_replace</strong> (<em>str</em>) – Dict with element symbol of specie to be replaced as keys and element
symbol of the species to be replaced with as values ({‘old_El’:’new_El’}).</p></li>
<li><p><strong>supercell_size</strong> (<em>int</em><em> or </em><em>numpy array</em>) – Input for the make_supercell function of the Structure class.
If None the input structure is not modified.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – <p>Kwargs to pass to SpaceGroupAnalyzer class:</p>
<ul>
<li><dl class="simple">
<dt>symprec (float):</dt><dd><p>Tolerance for symmetry finding. Defaults to 0.01,
which is fairly strict and works well for properly refined
structures with atoms in the proper symmetry coordinates. For
structures with slight deviations from their proper atomic
positions (e.g., structures relaxed with electronic structure
codes), a looser tolerance of 0.1 (the value used in Materials
Project) is often needed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>angle_tolerance (float):</dt><dd><p>Angle tolerance for symmetry finding. Defaults to 5 degrees.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>structures</strong> – List of substitution structures.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.create_vacancy_structures">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">create_vacancy_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#create_vacancy_structures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.create_vacancy_structures" title="Link to this definition"></a></dt>
<dd><p>Create Vacancy objects for each non-equivalent site,
staring from a bulk structure (unit cell or supercell).
Uses <cite>Vacancy</cite> objects generated with the <cite>generator</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – Bulk structure, both unit cell or supercell can be used as input.</p></li>
<li><p><strong>elements</strong> (<em>str</em>) – Symbol of the elements for which vacancies are needed.
If None all of the elements are considered.</p></li>
<li><p><strong>supercell_size</strong> (<em>int</em><em> or </em><em>numpy array</em>) – Input for the make_supercell function of the Structure class.
If None the input structure is not modified.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – <p>Kwargs to pass to SpaceGroupAnalyzer class:</p>
<ul>
<li><dl class="simple">
<dt>symprec (float):</dt><dd><p>Tolerance for symmetry finding. Defaults to 0.01,
which is fairly strict and works well for properly refined
structures with atoms in the proper symmetry coordinates. For
structures with slight deviations from their proper atomic
positions (e.g., structures relaxed with electronic structure
codes), a looser tolerance of 0.1 (the value used in Materials
Project) is often needed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>angle_tolerance (float):</dt><dd><p>Angle tolerance for symmetry finding. Defaults to 5 degrees.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>structures</strong> – List of vacancy structures.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.defect_finder">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">defect_finder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_defect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_bulk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_defects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#defect_finder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.defect_finder" title="Link to this definition"></a></dt>
<dd><p>Find defects by comparing defect and bulk structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_defect</strong> (<em>Structure</em>) – Defect structure.</p></li>
<li><p><strong>structure_bulk</strong> (<em>Structure</em>) – Bulk structure.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance for fractional coordinates comparison (default is 1e-3).</p></li>
<li><p><strong>max_number_of_defects</strong> (<em>int</em>) – Impose a max number of defects to be found. If set, defects
are ranked based on the coordinate distance btw defect and bulk sites
(descending order), the first max_number_of_defects in the list
are given as the output (as single defect or defect complex).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print output.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Defect object (<a class="reference internal" href="defermi.defects.html#defermi.defects.Vacancy" title="defermi.defects.Vacancy">Vacancy</a>, <a class="reference internal" href="defermi.defects.html#defermi.defects.Substitution" title="defermi.defects.Substitution">Substitution</a>, <a class="reference internal" href="defermi.defects.html#defermi.defects.Interstitial" title="defermi.defects.Interstitial">Interstitial</a>, <a class="reference internal" href="defermi.defects.html#defermi.defects.DefectComplex" title="defermi.defects.DefectComplex">DefectComplex</a>). Not implemented for Polaron.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.get_trajectory_for_visualization">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">get_trajectory_for_visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_defect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_bulk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#get_trajectory_for_visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.get_trajectory_for_visualization" title="Link to this definition"></a></dt>
<dd><p>Create trajectory from defect and bulk structures for visualization.
The vacancies are shown by inserting in the vacant site the element of same row and next group on the periodic table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_defect</strong> (<em>Structure</em>) – Defect structure.</p></li>
<li><p><strong>structure_bulk</strong> (<em>Structure</em>) – Bulk structure.</p></li>
<li><p><strong>defects</strong> (<em>list</em>) – List of Defect objects. If None <cite>defect_finder</cite> is used.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance for site comparison. The distance between sites in target and reference stucture is used,
periodicity is accounted for. The tolerance is normalized with respect to lattice vector size.
The default is 1e-03.</p></li>
<li><p><strong>file</strong> (<em>str</em>) – File to save XDATCAR.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_structure</strong> – Structure with dummy atoms as vacancies and interstitials in the bottom.
The order of the Sites follow the order of the Bulk structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="defermi.structure.write_extxyz_for_visualization">
<span class="sig-prename descclassname"><span class="pre">defermi.structure.</span></span><span class="sig-name descname"><span class="pre">write_extxyz_for_visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_defect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_bulk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/defermi/structure.html#write_extxyz_for_visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#defermi.structure.write_extxyz_for_visualization" title="Link to this definition"></a></dt>
<dd><p>Write extxyz file for visualization. The displacements w.r.t the bulk structure are included.
The vacancies are shown by inserting in the vacant site the element of same row and next group on the periodic table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Path to save file.</p></li>
<li><p><strong>structure_defect</strong> (<em>Structure</em>) – Defect structure.</p></li>
<li><p><strong>structure_bulk</strong> (<em>Structure</em>) – Bulk structure.</p></li>
<li><p><strong>defects</strong> (<em>list</em>) – List of Defect objects. If None <cite>defect_finder</cite> is used.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance for site comparison. The distance between sites in target and reference stucture is used,
periodicity is accounted for. The tolerance is normalized with respect to lattice vector size.
The default is 1e-03.</p></li>
</ul>
</dd>
</dl>
</dd></dl>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="defermi.plotter.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="defermi.thermodynamics.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Lorenzo Villa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>